# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã SSH

## üìä **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:**

### ‚úÖ **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. **DNS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ**: `tvlds-mvp001939.cloud.delta.sbrf.ru` ‚Üí `10.26.110.127`
2. **Ping –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: 20.5ms, 0% –ø–æ—Ç–µ—Ä—å –ø–∞–∫–µ—Ç–æ–≤
3. **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞**: –ú–∞—Ä—à—Ä—É—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. **Jenkins –∞–≥–µ–Ω—Ç**: `pvlss-jenci0064.sigma.sbrf.ru`
5. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–π–ø–ª–∞–π–Ω–∞**: –í—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
**–ü–æ—Ä—Ç 22 (SSH) –∑–∞–∫—Ä—ã—Ç/–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:**
```
[ERROR] –ü–æ—Ä—Ç 22 –∑–∞–∫—Ä—ã—Ç/–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
Ncat: Connection refused.
[DIAG] ‚ùå –ü–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç –ø–æ IP
telnet: connect to address 10.26.110.127: Connection refused
```

## üéØ **–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã:**
**–°–µ—Ä–≤–µ—Ä `tvlds-mvp001939.cloud.delta.sbrf.ru` (10.26.110.127) –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ç—É 22.**

## ü§î **–ü–æ—á–µ–º—É —Ä–µ–±–∏–ª–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç? –í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –†–∞–∑–Ω—ã–µ Jenkins –∞–≥–µ–Ω—Ç—ã (–Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ)
- **–û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫**: `pvlss-jenci0064` ‚Üí –ø–æ—Ä—Ç 22 –∑–∞–∫—Ä—ã—Ç
- **–†–µ–±–∏–ª–¥**: **–¥—Ä—É–≥–æ–π –∞–≥–µ–Ω—Ç** ‚Üí –ø–æ—Ä—Ç 22 –æ—Ç–∫—Ä—ã—Ç
- **–ü—Ä–∏—á–∏–Ω–∞**: –†–∞–∑–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏ –∏ —Å–µ—Ä–≤–µ—Ä–æ–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞
- SSH –¥–µ–º–æ–Ω –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω
- –§–∞–µ—Ä–≤–æ–ª –≤—Ä–µ–º–µ–Ω–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç 22
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –†–∞–∑–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤
- –†–µ–±–∏–ª–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–æ–π `SERVER_ADDRESS`

## üîß **–ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ Jenkinsfile –¥–ª—è —Ä–µ—à–µ–Ω–∏—è:**

### 1. **Retry –ª–æ–≥–∏–∫–∞** (3 –ø–æ–ø—ã—Ç–∫–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 10 —Å–µ–∫—É–Ω–¥)
```groovy
for (def attempt = 1; attempt <= maxRetries; attempt++) {
    try {
        echo "[RETRY] –ü–æ–ø—ã—Ç–∫–∞ $attempt –∏–∑ $maxRetries..."
        sh './scp_script.sh'
        break
    } catch (Exception e) {
        // –ñ–¥–µ–º –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
    }
}
```

### 2. **–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã SSH**
```bash
SSH_OPTS="-o StrictHostKeyChecking=no -o ConnectTimeout=30 \
          -o ServerAliveInterval=10 -o ServerAliveCountMax=3 \
          -o BatchMode=yes -o TCPKeepAlive=yes"
```

### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ SSH**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ —á–µ—Ä–µ–∑ netcat
- Verbose —Ä–µ–∂–∏–º SSH (—É—Ä–æ–≤–µ–Ω—å 3)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ IP –∞–¥—Ä–µ—Å
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## üöÄ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

### 1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—Ä—É—á–Ω—É—é:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ tvlds-mvp001939:
systemctl status sshd
netstat -tlnp | grep :22
firewall-cmd --list-all
iptables -L -n | grep 22
```

### 2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å –¥—Ä—É–≥–∏—Ö —Ö–æ—Å—Ç–æ–≤:**
```bash
# –° –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:
nc -zv tvlds-mvp001939.cloud.delta.sbrf.ru 22
ssh mvp_dev@tvlds-mvp001939.cloud.delta.sbrf.ru "echo test"
```

### 3. **–°—Ä–∞–≤–Ω–∏—Ç—å —Å —É—Å–ø–µ—à–Ω—ã–º —Ä–µ–±–∏–ª–¥–æ–º:**
- –ù–∞ –∫–∞–∫–æ–º Jenkins –∞–≥–µ–Ω—Ç–µ –∑–∞–ø—É—Å–∫–∞–ª—Å—è —Ä–µ–±–∏–ª–¥?
- –ö–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å?
- –í –∫–∞–∫–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç–∞–ª?

### 4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:**
- –§–∞–µ—Ä–≤–æ–ª –º–µ–∂–¥—É `pvlss-jenci0064` –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
- –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –°–µ—Ç–µ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ

## üìã **–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ª–∏—Ü–∞ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏:**

1. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —Å–µ—Ä–≤–µ—Ä–∞ `tvlds-mvp001939`** - –ø—Ä–æ–≤–µ—Ä–∫–∞ SSH –¥–µ–º–æ–Ω–∞
2. **–°–µ—Ç–µ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–µ—Ä–≤–æ–ª–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤
3. **Jenkins –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
4. **–ö–æ–º–∞–Ω–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞

## ‚è±Ô∏è **–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤—Ä–µ–º–µ–Ω–Ω–∞—è, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Jenkinsfile —Å:
- **Retry –ª–æ–≥–∏–∫–æ–π** (3 –ø–æ–ø—ã—Ç–∫–∏)
- **–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º–∏ —Ç–∞–π–º–∞—É—Ç–∞–º–∏**
- **–ü–æ–¥—Ä–æ–±–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π**

–º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –æ–±–æ–π—Ç–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é.

---

**–ò—Ç–æ–≥**: –ü—Ä–æ–±–ª–µ–º–∞ **–Ω–µ –≤ –≤–∞—à–µ–º –∫–æ–¥–µ**, –∞ –≤ **—Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** –º–µ–∂–¥—É Jenkins –∞–≥–µ–Ω—Ç–æ–º `pvlss-jenci0064` –∏ —Å–µ—Ä–≤–µ—Ä–æ–º `tvlds-mvp001939.cloud.delta.sbrf.ru`. –ü–æ—Ä—Ç—É 22 –æ—Ç–∫–∞–∑–∞–Ω–æ –≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏.
